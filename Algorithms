# imports
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import json
import os
import scipy.signal as signal
import scipy.stats as stats

# FCE method 1
def threshold_crossing_fce(input_signal, threshold, wait=20):

    idx = np.ones(len(input_signal))
    idx[input_signal < threshold] = 0

    fc = (np.array(np.where(np.diff(idx) == 1))).flatten()
    fo = (np.array(np.where(np.diff(idx) == -1)) + 1).flatten()
    
    fc, fo = peaks_wait_time(fc, fo, wait)

    fc, fo = fc_fo_delete(fc, fo)
    
    return fc, fo
